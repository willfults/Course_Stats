
<div class="container-fluid ">
  <div class="row-fluid">
    <div class="span2">
      <div id="facets">
        <h3>Course Ratings</h3>
        <ul>
          
          <% @facets.results.facets['course_ratings']['terms'].each do |facet| %>
            <li>
            <%= link_to_unless_current facet['term'], params.merge(course_rating: facet['term']) %>
            <% if params[:course_rating] == facet['term'].to_s 
              params.delete :course_rating
            %>
              (<%= link_to "remove", params %>)
            <% else %>
              (<%= facet['count'] %>)
            <% end %>
            </li>
            
            
          <% end %>
        </ul>
      </div>
      <div id="facets">
        <h3>Course Creator</h3>
        <ul>
          <% @facets.results.facets['authors']['terms'].each do |facet| %>
            <li>
              <%= facet['term'] %>
              (<%= facet['count'] %>)
            </li>
          <% end %>
        </ul>
      </div>
      <div id="facets">
        <h3>Industry</h3>
        <ul>
          <% @facets.results.facets['industries']['terms'].each do |facet| %>
            <li>
              <%= facet['term'] %>
              (<%= facet['count'] %>)
            </li>
          <% end %>
        </ul>
      </div>
    </div>
    <div class="span10">
      <%= @courses.results.total %>
      <table class="table table-hover search-results">
        <% 
        @courses.results.each do |course| 
          # Need to find a more effiecient way of doing this
          bookmark = current_user.bookmarks.where(:course_id => course.id).first
        %>
          <tr>
            <td>
              <div class="title"><%= link_to course.name, course_path(course) %></div>
              <div class="action" style="float:right;">
                <% if !bookmark %>
                  <%= link_to "Bookmark", course_path(course)+"/bookmark", :class => "btn btn-small btn-primary bookmark", :remote => true %>
                <% else %>
                  <span class="label">bookmarked</span>
                <% end %>
              </div>
              <div class="description"><%= truncate course.description, :length => 300 %></div>
              <div class="description">test: <%= truncate course.user_name, :length => 300 %></div>
              <%= ratings_for Course.find(course.id), :static %>
              CourseRate: <%=course.course_rating %>
            </td>
          </tr>
          
        <% end %>
      </table>
      
    </div>
  </div>
</div>
